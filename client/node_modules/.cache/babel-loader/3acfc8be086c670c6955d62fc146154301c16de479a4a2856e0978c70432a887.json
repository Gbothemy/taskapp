{"ast":null,"code":"import _objectSpread from\"C:/Users/HP/Desktop/TPAY/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{useForm}from'react-hook-form';import{ArrowLeftIcon,ClockIcon,CurrencyDollarIcon,UserIcon,CalendarIcon,DocumentTextIcon,PhotoIcon,LinkIcon,PaperClipIcon}from'@heroicons/react/24/outline';import{fetchTaskById,submitTask,clearCurrentTask}from'../../store/slices/taskSlice';import LoadingSpinner from'../../components/ui/LoadingSpinner';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TaskDetail=()=>{var _currentTask$qualityR,_currentTask$qualityR2,_currentTask$qualityR3,_currentTask$qualityR4;const{id}=useParams();const navigate=useNavigate();const dispatch=useDispatch();const{currentTask,loading}=useSelector(state=>state.tasks);const{user}=useSelector(state=>state.auth);const[showSubmissionForm,setShowSubmissionForm]=useState(false);const[submitting,setSubmitting]=useState(false);const{register,handleSubmit,watch,formState:{errors}}=useForm();const proofType=watch('proofType',currentTask===null||currentTask===void 0?void 0:currentTask.requiredProofType);useEffect(()=>{if(id){dispatch(fetchTaskById(id));}return()=>{dispatch(clearCurrentTask());};},[dispatch,id]);const handleSubmitTask=async data=>{setSubmitting(true);try{const proofData={type:currentTask.requiredProofType,content:data.content};await dispatch(submitTask({taskId:id,proofData})).unwrap();toast.success('Task submitted successfully!');navigate('/my-submissions');}catch(error){toast.error(error||'Failed to submit task');}finally{setSubmitting(false);}};const getCategoryColor=category=>{const colors={'data-entry':'bg-blue-100 text-blue-800','content':'bg-purple-100 text-purple-800','review':'bg-green-100 text-green-800','research':'bg-yellow-100 text-yellow-800','testing':'bg-red-100 text-red-800','design':'bg-pink-100 text-pink-800','other':'bg-gray-100 text-gray-800'};return colors[category]||'bg-gray-100 text-gray-800';};const getProofIcon=type=>{switch(type){case'image':return PhotoIcon;case'text':return DocumentTextIcon;case'url':return LinkIcon;case'file':return PaperClipIcon;default:return DocumentTextIcon;}};const formatDeadline=deadline=>{const date=new Date(deadline);const now=new Date();const diffTime=date-now;const diffDays=Math.ceil(diffTime/(1000*60*60*24));if(diffDays<0)return{text:'Expired',color:'text-red-600'};if(diffDays===0)return{text:'Due Today',color:'text-red-600'};if(diffDays===1)return{text:'Due Tomorrow',color:'text-yellow-600'};if(diffDays<=7)return{text:\"\".concat(diffDays,\" days left\"),color:'text-yellow-600'};return{text:\"\".concat(diffDays,\" days left\"),color:'text-green-600'};};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"lg\"})});}if(!currentTask){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:\"Task not found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"The task you're looking for doesn't exist.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/tasks'),className:\"btn-primary\",children:\"Browse Tasks\"})]})});}const deadline=formatDeadline(currentTask.deadline);const ProofIcon=getProofIcon(currentTask.requiredProofType);const remainingTasks=currentTask.totalTasksNeeded-currentTask.completedTasks;const canSubmit=remainingTasks>0&&currentTask.status==='active';return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate('/tasks'),className:\"flex items-center text-gray-600 hover:text-gray-900 mb-4\",children:[/*#__PURE__*/_jsx(ArrowLeftIcon,{className:\"h-4 w-4 mr-2\"}),\"Back to Tasks\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"badge \".concat(getCategoryColor(currentTask.category)),children:currentTask.category.replace('-',' ')}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium \".concat(deadline.color),children:deadline.text})]}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-2\",children:currentTask.title})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-3xl font-bold text-primary-600\",children:[\"$\",currentTask.payoutPerTask]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"per task\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Description\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 whitespace-pre-wrap\",children:currentTask.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Instructions\"}),/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm max-w-none\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 whitespace-pre-wrap\",children:currentTask.instructions})})]}),canSubmit&&/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900\",children:\"Submit Your Work\"}),!showSubmissionForm&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSubmissionForm(true),className:\"btn-primary\",children:\"Start Submission\"})]}),showSubmissionForm&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(handleSubmitTask),className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(ProofIcon,{className:\"h-4 w-4 inline mr-1\"}),\"Required Proof: \",currentTask.requiredProofType]}),currentTask.requiredProofType==='text'&&/*#__PURE__*/_jsx(\"textarea\",_objectSpread(_objectSpread({},register('content',{required:'Please provide your work details',minLength:{value:10,message:'Please provide at least 10 characters'}})),{},{rows:6,className:\"input-field\",placeholder:\"Describe your completed work in detail...\"})),currentTask.requiredProofType==='url'&&/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},register('content',{required:'Please provide a valid URL',pattern:{value:/^https?:\\/\\/.+/,message:'Please enter a valid URL starting with http:// or https://'}})),{},{type:\"url\",className:\"input-field\",placeholder:\"https://example.com/your-work\"})),currentTask.requiredProofType==='image'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},register('content',{required:'Please provide an image URL or description'})),{},{type:\"text\",className:\"input-field\",placeholder:\"Image URL or description of uploaded image\"})),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"For demo purposes, please provide an image URL or description\"})]}),currentTask.requiredProofType==='file'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},register('content',{required:'Please provide file details or URL'})),{},{type:\"text\",className:\"input-field\",placeholder:\"File URL or description of uploaded file\"})),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:\"For demo purposes, please provide a file URL or description\"})]}),errors.content&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:errors.content.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:submitting,className:\"btn-primary flex items-center\",children:submitting?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LoadingSpinner,{size:\"sm\",className:\"mr-2\"}),\"Submitting...\"]}):'Submit Task'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowSubmissionForm(false),className:\"btn-outline\",children:\"Cancel\"})]})]})]}),!canSubmit&&/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6 bg-yellow-50 border-yellow-200\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-yellow-800 mb-2\",children:\"Task Not Available\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-yellow-700\",children:remainingTasks<=0?'This task has been completed by other workers.':'This task is currently not accepting submissions.'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Task Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"h-4 w-4 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Payout\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"$\",currentTask.payoutPerTask]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(UserIcon,{className:\"h-4 w-4 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Remaining\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:remainingTasks})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(ClockIcon,{className:\"h-4 w-4 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Deadline\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold \".concat(deadline.color),children:new Date(currentTask.deadline).toLocaleDateString()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-gray-600\",children:[/*#__PURE__*/_jsx(ProofIcon,{className:\"h-4 w-4 mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Proof Type\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold capitalize\",children:currentTask.requiredProofType})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Requirements\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Min Approval Rate\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[((_currentTask$qualityR=currentTask.qualityRequirements)===null||_currentTask$qualityR===void 0?void 0:_currentTask$qualityR.minApprovalRate)||80,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Worker Level\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"Level \",((_currentTask$qualityR2=currentTask.qualityRequirements)===null||_currentTask$qualityR2===void 0?void 0:_currentTask$qualityR2.workerLevel)||1,\"+\"]})]})]}),(user===null||user===void 0?void 0:user.workerStats)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-medium text-gray-900 mb-2\",children:\"Your Stats\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Your Approval Rate\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold \".concat(user.workerStats.approvalRate>=(((_currentTask$qualityR3=currentTask.qualityRequirements)===null||_currentTask$qualityR3===void 0?void 0:_currentTask$qualityR3.minApprovalRate)||80)?'text-green-600':'text-red-600'),children:[user.workerStats.approvalRate.toFixed(1),\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Your Level\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold \".concat(user.workerStats.level>=(((_currentTask$qualityR4=currentTask.qualityRequirements)===null||_currentTask$qualityR4===void 0?void 0:_currentTask$qualityR4.workerLevel)||1)?'text-green-600':'text-red-600'),children:[\"Level \",user.workerStats.level]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Progress\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Completed\"}),/*#__PURE__*/_jsxs(\"span\",{children:[currentTask.completedTasks,\" / \",currentTask.totalTasksNeeded]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-primary-500 h-2 rounded-full transition-all duration-300\",style:{width:\"\".concat(currentTask.completedTasks/currentTask.totalTasksNeeded*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[Math.round(currentTask.completedTasks/currentTask.totalTasksNeeded*100),\"% complete\"]})]})]})]})]})]})});};export default TaskDetail;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}