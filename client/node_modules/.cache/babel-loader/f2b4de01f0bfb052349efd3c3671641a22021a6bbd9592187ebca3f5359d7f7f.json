{"ast":null,"code":"import{createSlice}from'@reduxjs/toolkit';import io from'socket.io-client';import{addNotification}from'./notificationSlice';import{updateBalance}from'./walletSlice';const initialState={connection:null,connected:false};const socketSlice=createSlice({name:'socket',initialState,reducers:{setSocket:(state,action)=>{state.connection=action.payload;state.connected=true;},disconnectSocket:state=>{if(state.connection){state.connection.disconnect();}state.connection=null;state.connected=false;}}});export const{setSocket,disconnectSocket}=socketSlice.actions;// Thunk for initializing socket connection\nexport const initializeSocket=userId=>dispatch=>{const socket=io(process.env.REACT_APP_API_URL||'http://localhost:5000');socket.on('connect',()=>{console.log('Connected to server');socket.emit('join',userId);dispatch(setSocket(socket));});socket.on('disconnect',()=>{console.log('Disconnected from server');dispatch(disconnectSocket());});// Handle real-time notifications\nsocket.on('new_task',data=>{dispatch(addNotification({type:'info',title:'New Task Available',message:data.message,data:data.task}));});socket.on('new_submission',data=>{dispatch(addNotification({type:'info',title:'New Submission',message:\"\".concat(data.worker.firstName,\" \").concat(data.worker.lastName,\" submitted work for \\\"\").concat(data.task.title,\"\\\"\"),data:data.submission}));});socket.on('task_approved',data=>{dispatch(addNotification({type:'success',title:'Task Approved!',message:\"Your submission for \\\"\".concat(data.task.title,\"\\\" was approved. You earned $\").concat(data.earnings,\"!\"),data:data.submission}));// Update wallet balance\ndispatch(updateBalance(data.earnings));});socket.on('task_rejected',data=>{dispatch(addNotification({type:'error',title:'Task Rejected',message:\"Your submission for \\\"\".concat(data.task.title,\"\\\" was rejected. Please review the feedback.\"),data:data.submission}));});socket.on('account_status_changed',data=>{dispatch(addNotification({type:data.status==='active'?'success':'warning',title:'Account Status Changed',message:data.message}));});return socket;};export default socketSlice.reducer;","map":{"version":3,"names":["createSlice","io","addNotification","updateBalance","initialState","connection","connected","socketSlice","name","reducers","setSocket","state","action","payload","disconnectSocket","disconnect","actions","initializeSocket","userId","dispatch","socket","process","env","REACT_APP_API_URL","on","console","log","emit","data","type","title","message","task","concat","worker","firstName","lastName","submission","earnings","status","reducer"],"sources":["C:/Users/HP/Desktop/TPAY/client/src/store/slices/socketSlice.js"],"sourcesContent":["import { createSlice } from '@reduxjs/toolkit';\r\nimport io from 'socket.io-client';\r\nimport { addNotification } from './notificationSlice';\r\nimport { updateBalance } from './walletSlice';\r\n\r\nconst initialState = {\r\n  connection: null,\r\n  connected: false,\r\n};\r\n\r\nconst socketSlice = createSlice({\r\n  name: 'socket',\r\n  initialState,\r\n  reducers: {\r\n    setSocket: (state, action) => {\r\n      state.connection = action.payload;\r\n      state.connected = true;\r\n    },\r\n    disconnectSocket: (state) => {\r\n      if (state.connection) {\r\n        state.connection.disconnect();\r\n      }\r\n      state.connection = null;\r\n      state.connected = false;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { setSocket, disconnectSocket } = socketSlice.actions;\r\n\r\n// Thunk for initializing socket connection\r\nexport const initializeSocket = (userId) => (dispatch) => {\r\n  const socket = io(process.env.REACT_APP_API_URL || 'http://localhost:5000');\r\n  \r\n  socket.on('connect', () => {\r\n    console.log('Connected to server');\r\n    socket.emit('join', userId);\r\n    dispatch(setSocket(socket));\r\n  });\r\n\r\n  socket.on('disconnect', () => {\r\n    console.log('Disconnected from server');\r\n    dispatch(disconnectSocket());\r\n  });\r\n\r\n  // Handle real-time notifications\r\n  socket.on('new_task', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'info',\r\n      title: 'New Task Available',\r\n      message: data.message,\r\n      data: data.task,\r\n    }));\r\n  });\r\n\r\n  socket.on('new_submission', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'info',\r\n      title: 'New Submission',\r\n      message: `${data.worker.firstName} ${data.worker.lastName} submitted work for \"${data.task.title}\"`,\r\n      data: data.submission,\r\n    }));\r\n  });\r\n\r\n  socket.on('task_approved', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'success',\r\n      title: 'Task Approved!',\r\n      message: `Your submission for \"${data.task.title}\" was approved. You earned $${data.earnings}!`,\r\n      data: data.submission,\r\n    }));\r\n    \r\n    // Update wallet balance\r\n    dispatch(updateBalance(data.earnings));\r\n  });\r\n\r\n  socket.on('task_rejected', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'error',\r\n      title: 'Task Rejected',\r\n      message: `Your submission for \"${data.task.title}\" was rejected. Please review the feedback.`,\r\n      data: data.submission,\r\n    }));\r\n  });\r\n\r\n  socket.on('account_status_changed', (data) => {\r\n    dispatch(addNotification({\r\n      type: data.status === 'active' ? 'success' : 'warning',\r\n      title: 'Account Status Changed',\r\n      message: data.message,\r\n    }));\r\n  });\r\n\r\n  return socket;\r\n};\r\n\r\nexport default socketSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}