{"ast":null,"code":"import _objectSpread from\"C:/Users/HP/Desktop/TPAY/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{useForm}from'react-hook-form';import{CurrencyDollarIcon,ArrowUpIcon,ArrowDownIcon,PlusIcon,BanknotesIcon,ClockIcon}from'@heroicons/react/24/outline';import{fetchWallet,fetchTransactions,requestWithdrawal,depositFunds}from'../../store/slices/walletSlice';import LoadingSpinner from'../../components/ui/LoadingSpinner';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Wallet=()=>{var _wallet$balance,_wallet$pendingEarnin,_wallet$totalEarned,_wallet$totalSpent,_withdrawErrors$detai;const dispatch=useDispatch();const{wallet,transactions,loading}=useSelector(state=>state.wallet);const{user}=useSelector(state=>state.auth);const[showWithdrawModal,setShowWithdrawModal]=useState(false);const[showDepositModal,setShowDepositModal]=useState(false);const{register:registerWithdraw,handleSubmit:handleWithdrawSubmit,formState:{errors:withdrawErrors},reset:resetWithdraw}=useForm();const{register:registerDeposit,handleSubmit:handleDepositSubmit,formState:{errors:depositErrors},reset:resetDeposit}=useForm();useEffect(()=>{dispatch(fetchWallet());dispatch(fetchTransactions());},[dispatch]);const handleWithdrawal=async data=>{try{await dispatch(requestWithdrawal(data)).unwrap();toast.success('Withdrawal request submitted successfully!');setShowWithdrawModal(false);resetWithdraw();dispatch(fetchWallet());dispatch(fetchTransactions());}catch(error){toast.error(error||'Failed to process withdrawal');}};const handleDeposit=async data=>{try{await dispatch(depositFunds(data)).unwrap();toast.success('Funds deposited successfully!');setShowDepositModal(false);resetDeposit();dispatch(fetchWallet());dispatch(fetchTransactions());}catch(error){toast.error(error||'Failed to process deposit');}};const getTransactionIcon=type=>{switch(type){case'task_payment':return/*#__PURE__*/_jsx(ArrowUpIcon,{className:\"h-5 w-5 text-green-500\"});case'withdrawal':return/*#__PURE__*/_jsx(ArrowDownIcon,{className:\"h-5 w-5 text-red-500\"});case'deposit':return/*#__PURE__*/_jsx(ArrowUpIcon,{className:\"h-5 w-5 text-blue-500\"});case'platform_fee':return/*#__PURE__*/_jsx(ArrowDownIcon,{className:\"h-5 w-5 text-gray-500\"});default:return/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"h-5 w-5 text-gray-500\"});}};const getTransactionColor=(type,amount)=>{if(amount>0)return'text-green-600';if(amount<0)return'text-red-600';return'text-gray-600';};const formatTransactionType=type=>{const types={task_payment:'Task Payment',withdrawal:'Withdrawal',deposit:'Deposit',platform_fee:'Platform Fee',refund:'Refund'};return types[type]||type;};const getStatusBadge=status=>{const badges={pending:'badge-warning',completed:'badge-success',failed:'badge-error',cancelled:'badge-info'};return badges[status]||'badge-info';};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900\",children:\"Wallet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-2\",children:\"Manage your balance, view transactions, and withdraw earnings.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-lg bg-green-100\",children:/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"h-6 w-6 text-green-600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Available Balance\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:[\"$\",((_wallet$balance=wallet.balance)===null||_wallet$balance===void 0?void 0:_wallet$balance.toFixed(2))||'0.00']})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-lg bg-yellow-100\",children:/*#__PURE__*/_jsx(ClockIcon,{className:\"h-6 w-6 text-yellow-600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Pending Earnings\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:[\"$\",((_wallet$pendingEarnin=wallet.pendingEarnings)===null||_wallet$pendingEarnin===void 0?void 0:_wallet$pendingEarnin.toFixed(2))||'0.00']})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-lg bg-blue-100\",children:/*#__PURE__*/_jsx(ArrowUpIcon,{className:\"h-6 w-6 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Total Earned\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:[\"$\",((_wallet$totalEarned=wallet.totalEarned)===null||_wallet$totalEarned===void 0?void 0:_wallet$totalEarned.toFixed(2))||'0.00']})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-3 rounded-lg bg-purple-100\",children:/*#__PURE__*/_jsx(ArrowDownIcon,{className:\"h-6 w-6 text-purple-600\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-600\",children:\"Total Spent\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl font-bold text-gray-900\",children:[\"$\",((_wallet$totalSpent=wallet.totalSpent)===null||_wallet$totalSpent===void 0?void 0:_wallet$totalSpent.toFixed(2))||'0.00']})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-4 mb-8\",children:[(user===null||user===void 0?void 0:user.role)==='worker'&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowWithdrawModal(true),disabled:wallet.balance<10,className:\"btn-primary flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed\",children:[/*#__PURE__*/_jsx(ArrowDownIcon,{className:\"h-4 w-4 mr-2\"}),\"Withdraw Funds\"]}),(user===null||user===void 0?void 0:user.role)==='employer'&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowDepositModal(true),className:\"btn-primary flex items-center justify-center\",children:[/*#__PURE__*/_jsx(PlusIcon,{className:\"h-4 w-4 mr-2\"}),\"Add Funds\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>dispatch(fetchTransactions()),className:\"btn-outline flex items-center justify-center\",children:[/*#__PURE__*/_jsx(BanknotesIcon,{className:\"h-4 w-4 mr-2\"}),\"Refresh\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Transaction History\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center py-8\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"md\"})}):transactions.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(CurrencyDollarIcon,{className:\"h-12 w-12 text-gray-300 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No transactions yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-400 mt-2\",children:\"Your transaction history will appear here\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:transactions.map(transaction=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:getTransactionIcon(transaction.type)}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:formatTransactionType(transaction.type)}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[new Date(transaction.createdAt).toLocaleDateString(),\" at\",' ',new Date(transaction.createdAt).toLocaleTimeString()]}),transaction.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500\",children:transaction.description})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"font-semibold \".concat(getTransactionColor(transaction.type,transaction.amount)),children:[transaction.amount>0?'+':'',\"$\",Math.abs(transaction.amount).toFixed(2)]}),/*#__PURE__*/_jsx(\"span\",{className:\"badge \".concat(getStatusBadge(transaction.status),\" text-xs\"),children:transaction.status})]})]},transaction.id))})]}),showWithdrawModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 w-full max-w-md mx-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Withdraw Funds\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleWithdrawSubmit(handleWithdrawal),className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},registerWithdraw('amount',{required:'Amount is required',min:{value:10,message:'Minimum withdrawal is $10'},max:{value:wallet.balance,message:'Amount exceeds available balance'}})),{},{type:\"number\",step:\"0.01\",className:\"input-field\",placeholder:\"Enter amount\"})),withdrawErrors.amount&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:withdrawErrors.amount.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Withdrawal Method\"}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({},registerWithdraw('method',{required:'Please select a method'})),{},{className:\"input-field\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select method\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paypal\",children:\"PayPal\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bank_transfer\",children:\"Bank Transfer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"crypto\",children:\"Cryptocurrency\"})]})),withdrawErrors.method&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:withdrawErrors.method.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Payment Details\"}),/*#__PURE__*/_jsx(\"textarea\",_objectSpread(_objectSpread({},registerWithdraw('details.account',{required:'Payment details are required'})),{},{className:\"input-field\",rows:3,placeholder:\"Enter your payment account details\"})),((_withdrawErrors$detai=withdrawErrors.details)===null||_withdrawErrors$detai===void 0?void 0:_withdrawErrors$detai.account)&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:withdrawErrors.details.account.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"btn-primary flex-1\",children:loading?'Processing...':'Submit Withdrawal'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowWithdrawModal(false),className:\"btn-outline flex-1\",children:\"Cancel\"})]})]})]})}),showDepositModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-6 w-full max-w-md mx-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Add Funds\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleDepositSubmit(handleDeposit),className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},registerDeposit('amount',{required:'Amount is required',min:{value:1,message:'Minimum deposit is $1'}})),{},{type:\"number\",step:\"0.01\",className:\"input-field\",placeholder:\"Enter amount\"})),depositErrors.amount&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:depositErrors.amount.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({},registerDeposit('method',{required:'Please select a method'})),{},{className:\"input-field\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select method\"}),/*#__PURE__*/_jsx(\"option\",{value:\"demo\",children:\"Demo (Instant)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"stripe\",children:\"Credit Card (Stripe)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"paypal\",children:\"PayPal\"})]})),depositErrors.method&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-red-600\",children:depositErrors.method.message})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-50 border border-blue-200 rounded-lg p-3\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-blue-800\",children:\"\\uD83D\\uDCA1 This is a demo environment. Funds will be added instantly for testing purposes.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"btn-primary flex-1\",children:loading?'Processing...':'Add Funds'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowDepositModal(false),className:\"btn-outline flex-1\",children:\"Cancel\"})]})]})]})})]})});};export default Wallet;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}