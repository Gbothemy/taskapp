{"ast":null,"code":"import{createSlice,createAsyncThunk}from'@reduxjs/toolkit';import axios from'axios';// Create a separate API instance to avoid circular dependency\nconst walletApi=axios.create({baseURL:process.env.REACT_APP_API_URL||'http://localhost:5000/api',headers:{'Content-Type':'application/json'}});// Add token interceptor\nwalletApi.interceptors.request.use(config=>{const token=localStorage.getItem('accessToken');if(token){config.headers.Authorization=\"Bearer \".concat(token);}return config;});// Async thunks\nexport const fetchWallet=createAsyncThunk('wallet/fetchWallet',async(_,_ref)=>{let{rejectWithValue}=_ref;try{const response=await walletApi.get('/payments/wallet');return response.data.wallet;}catch(error){var _error$response,_error$response$data;return rejectWithValue(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Failed to fetch wallet');}});export const fetchTransactions=createAsyncThunk('wallet/fetchTransactions',async function(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let{rejectWithValue}=arguments.length>1?arguments[1]:undefined;try{const response=await walletApi.get('/payments/transactions',{params});return response.data;}catch(error){var _error$response2,_error$response2$data;return rejectWithValue(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Failed to fetch transactions');}});export const requestWithdrawal=createAsyncThunk('wallet/requestWithdrawal',async(withdrawalData,_ref2)=>{let{rejectWithValue}=_ref2;try{const response=await walletApi.post('/payments/withdraw',withdrawalData);return response.data.transaction;}catch(error){var _error$response3,_error$response3$data;return rejectWithValue(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Failed to request withdrawal');}});export const depositFunds=createAsyncThunk('wallet/depositFunds',async(depositData,_ref3)=>{let{rejectWithValue}=_ref3;try{const response=await walletApi.post('/payments/deposit',depositData);return response.data.transaction;}catch(error){var _error$response4,_error$response4$data;return rejectWithValue(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||'Failed to deposit funds');}});const initialState={wallet:{balance:0,pendingEarnings:0,totalEarned:0,totalSpent:0},transactions:[],pagination:{currentPage:1,totalPages:1,totalTransactions:0,hasNext:false,hasPrev:false},loading:false,error:null};const walletSlice=createSlice({name:'wallet',initialState,reducers:{clearError:state=>{state.error=null;},updateBalance:(state,action)=>{state.wallet.balance=action.payload;},addTransaction:(state,action)=>{state.transactions.unshift(action.payload);}},extraReducers:builder=>{builder// Fetch Wallet\n.addCase(fetchWallet.pending,state=>{state.loading=true;state.error=null;}).addCase(fetchWallet.fulfilled,(state,action)=>{state.loading=false;state.wallet=action.payload;}).addCase(fetchWallet.rejected,(state,action)=>{state.loading=false;state.error=action.payload;})// Fetch Transactions\n.addCase(fetchTransactions.pending,state=>{state.loading=true;state.error=null;}).addCase(fetchTransactions.fulfilled,(state,action)=>{state.loading=false;state.transactions=action.payload.transactions;state.pagination=action.payload.pagination;}).addCase(fetchTransactions.rejected,(state,action)=>{state.loading=false;state.error=action.payload;})// Request Withdrawal\n.addCase(requestWithdrawal.pending,state=>{state.loading=true;state.error=null;}).addCase(requestWithdrawal.fulfilled,(state,action)=>{state.loading=false;state.transactions.unshift(action.payload);// Update balance (withdrawal amount is negative)\nstate.wallet.balance+=action.payload.amount;}).addCase(requestWithdrawal.rejected,(state,action)=>{state.loading=false;state.error=action.payload;})// Deposit Funds\n.addCase(depositFunds.pending,state=>{state.loading=true;state.error=null;}).addCase(depositFunds.fulfilled,(state,action)=>{state.loading=false;state.transactions.unshift(action.payload);state.wallet.balance+=action.payload.amount;}).addCase(depositFunds.rejected,(state,action)=>{state.loading=false;state.error=action.payload;});}});export const{clearError,updateBalance,addTransaction}=walletSlice.actions;export default walletSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","walletApi","create","baseURL","process","env","REACT_APP_API_URL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","concat","fetchWallet","_","_ref","rejectWithValue","response","get","data","wallet","error","_error$response","_error$response$data","message","fetchTransactions","params","arguments","length","undefined","_error$response2","_error$response2$data","requestWithdrawal","withdrawalData","_ref2","post","transaction","_error$response3","_error$response3$data","depositFunds","depositData","_ref3","_error$response4","_error$response4$data","initialState","balance","pendingEarnings","totalEarned","totalSpent","transactions","pagination","currentPage","totalPages","totalTransactions","hasNext","hasPrev","loading","walletSlice","name","reducers","clearError","state","updateBalance","action","payload","addTransaction","unshift","extraReducers","builder","addCase","pending","fulfilled","rejected","amount","actions","reducer"],"sources":["C:/Users/HP/Desktop/TPAY/client/src/store/slices/walletSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\n// Create a separate API instance to avoid circular dependency\r\nconst walletApi = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:5000/api',\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Add token interceptor\r\nwalletApi.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem('accessToken');\r\n  if (token) {\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n});\r\n\r\n// Async thunks\r\nexport const fetchWallet = createAsyncThunk(\r\n  'wallet/fetchWallet',\r\n  async (_, { rejectWithValue }) => {\r\n    try {\r\n      const response = await walletApi.get('/payments/wallet');\r\n      return response.data.wallet;\r\n    } catch (error) {\r\n      return rejectWithValue(error.response?.data?.message || 'Failed to fetch wallet');\r\n    }\r\n  }\r\n);\r\n\r\nexport const fetchTransactions = createAsyncThunk(\r\n  'wallet/fetchTransactions',\r\n  async (params = {}, { rejectWithValue }) => {\r\n    try {\r\n      const response = await walletApi.get('/payments/transactions', { params });\r\n      return response.data;\r\n    } catch (error) {\r\n      return rejectWithValue(error.response?.data?.message || 'Failed to fetch transactions');\r\n    }\r\n  }\r\n);\r\n\r\nexport const requestWithdrawal = createAsyncThunk(\r\n  'wallet/requestWithdrawal',\r\n  async (withdrawalData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await walletApi.post('/payments/withdraw', withdrawalData);\r\n      return response.data.transaction;\r\n    } catch (error) {\r\n      return rejectWithValue(error.response?.data?.message || 'Failed to request withdrawal');\r\n    }\r\n  }\r\n);\r\n\r\nexport const depositFunds = createAsyncThunk(\r\n  'wallet/depositFunds',\r\n  async (depositData, { rejectWithValue }) => {\r\n    try {\r\n      const response = await walletApi.post('/payments/deposit', depositData);\r\n      return response.data.transaction;\r\n    } catch (error) {\r\n      return rejectWithValue(error.response?.data?.message || 'Failed to deposit funds');\r\n    }\r\n  }\r\n);\r\n\r\nconst initialState = {\r\n  wallet: {\r\n    balance: 0,\r\n    pendingEarnings: 0,\r\n    totalEarned: 0,\r\n    totalSpent: 0,\r\n  },\r\n  transactions: [],\r\n  pagination: {\r\n    currentPage: 1,\r\n    totalPages: 1,\r\n    totalTransactions: 0,\r\n    hasNext: false,\r\n    hasPrev: false,\r\n  },\r\n  loading: false,\r\n  error: null,\r\n};\r\n\r\nconst walletSlice = createSlice({\r\n  name: 'wallet',\r\n  initialState,\r\n  reducers: {\r\n    clearError: (state) => {\r\n      state.error = null;\r\n    },\r\n    updateBalance: (state, action) => {\r\n      state.wallet.balance = action.payload;\r\n    },\r\n    addTransaction: (state, action) => {\r\n      state.transactions.unshift(action.payload);\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      // Fetch Wallet\r\n      .addCase(fetchWallet.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchWallet.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.wallet = action.payload;\r\n      })\r\n      .addCase(fetchWallet.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Fetch Transactions\r\n      .addCase(fetchTransactions.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(fetchTransactions.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.transactions = action.payload.transactions;\r\n        state.pagination = action.payload.pagination;\r\n      })\r\n      .addCase(fetchTransactions.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Request Withdrawal\r\n      .addCase(requestWithdrawal.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(requestWithdrawal.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.transactions.unshift(action.payload);\r\n        // Update balance (withdrawal amount is negative)\r\n        state.wallet.balance += action.payload.amount;\r\n      })\r\n      .addCase(requestWithdrawal.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      })\r\n      // Deposit Funds\r\n      .addCase(depositFunds.pending, (state) => {\r\n        state.loading = true;\r\n        state.error = null;\r\n      })\r\n      .addCase(depositFunds.fulfilled, (state, action) => {\r\n        state.loading = false;\r\n        state.transactions.unshift(action.payload);\r\n        state.wallet.balance += action.payload.amount;\r\n      })\r\n      .addCase(depositFunds.rejected, (state, action) => {\r\n        state.loading = false;\r\n        state.error = action.payload;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { clearError, updateBalance, addTransaction } = walletSlice.actions;\r\nexport default walletSlice.reducer;"],"mappings":"AAAA,OAASA,WAAW,CAAEC,gBAAgB,KAAQ,kBAAkB,CAChE,MAAO,CAAAC,KAAK,KAAM,OAAO,CAEzB;AACA,KAAM,CAAAC,SAAS,CAAGD,KAAK,CAACE,MAAM,CAAC,CAC7BC,OAAO,CAAEC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,2BAA2B,CACrEC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,CAEF;AACAN,SAAS,CAACO,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,EAAK,CAC7C,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,CACjD,GAAIF,KAAK,CAAE,CACTD,MAAM,CAACJ,OAAO,CAACQ,aAAa,WAAAC,MAAA,CAAaJ,KAAK,CAAE,CAClD,CACA,MAAO,CAAAD,MAAM,CACf,CAAC,CAAC,CAEF;AACA,MAAO,MAAM,CAAAM,WAAW,CAAGlB,gBAAgB,CACzC,oBAAoB,CACpB,MAAOmB,CAAC,CAAAC,IAAA,GAA0B,IAAxB,CAAEC,eAAgB,CAAC,CAAAD,IAAA,CAC3B,GAAI,CACF,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAApB,SAAS,CAACqB,GAAG,CAAC,kBAAkB,CAAC,CACxD,MAAO,CAAAD,QAAQ,CAACE,IAAI,CAACC,MAAM,CAC7B,CAAE,MAAOC,KAAK,CAAE,KAAAC,eAAA,CAAAC,oBAAA,CACd,MAAO,CAAAP,eAAe,CAAC,EAAAM,eAAA,CAAAD,KAAK,CAACJ,QAAQ,UAAAK,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBH,IAAI,UAAAI,oBAAA,iBAApBA,oBAAA,CAAsBC,OAAO,GAAI,wBAAwB,CAAC,CACnF,CACF,CACF,CAAC,CAED,MAAO,MAAM,CAAAC,iBAAiB,CAAG9B,gBAAgB,CAC/C,0BAA0B,CAC1B,gBAA4C,IAArC,CAAA+B,MAAM,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,CAAC,CAAC,IAAE,CAAEX,eAAgB,CAAC,CAAAW,SAAA,CAAAC,MAAA,GAAAD,SAAA,IAAAE,SAAA,CACrC,GAAI,CACF,KAAM,CAAAZ,QAAQ,CAAG,KAAM,CAAApB,SAAS,CAACqB,GAAG,CAAC,wBAAwB,CAAE,CAAEQ,MAAO,CAAC,CAAC,CAC1E,MAAO,CAAAT,QAAQ,CAACE,IAAI,CACtB,CAAE,MAAOE,KAAK,CAAE,KAAAS,gBAAA,CAAAC,qBAAA,CACd,MAAO,CAAAf,eAAe,CAAC,EAAAc,gBAAA,CAAAT,KAAK,CAACJ,QAAQ,UAAAa,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBX,IAAI,UAAAY,qBAAA,iBAApBA,qBAAA,CAAsBP,OAAO,GAAI,8BAA8B,CAAC,CACzF,CACF,CACF,CAAC,CAED,MAAO,MAAM,CAAAQ,iBAAiB,CAAGrC,gBAAgB,CAC/C,0BAA0B,CAC1B,MAAOsC,cAAc,CAAAC,KAAA,GAA0B,IAAxB,CAAElB,eAAgB,CAAC,CAAAkB,KAAA,CACxC,GAAI,CACF,KAAM,CAAAjB,QAAQ,CAAG,KAAM,CAAApB,SAAS,CAACsC,IAAI,CAAC,oBAAoB,CAAEF,cAAc,CAAC,CAC3E,MAAO,CAAAhB,QAAQ,CAACE,IAAI,CAACiB,WAAW,CAClC,CAAE,MAAOf,KAAK,CAAE,KAAAgB,gBAAA,CAAAC,qBAAA,CACd,MAAO,CAAAtB,eAAe,CAAC,EAAAqB,gBAAA,CAAAhB,KAAK,CAACJ,QAAQ,UAAAoB,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBlB,IAAI,UAAAmB,qBAAA,iBAApBA,qBAAA,CAAsBd,OAAO,GAAI,8BAA8B,CAAC,CACzF,CACF,CACF,CAAC,CAED,MAAO,MAAM,CAAAe,YAAY,CAAG5C,gBAAgB,CAC1C,qBAAqB,CACrB,MAAO6C,WAAW,CAAAC,KAAA,GAA0B,IAAxB,CAAEzB,eAAgB,CAAC,CAAAyB,KAAA,CACrC,GAAI,CACF,KAAM,CAAAxB,QAAQ,CAAG,KAAM,CAAApB,SAAS,CAACsC,IAAI,CAAC,mBAAmB,CAAEK,WAAW,CAAC,CACvE,MAAO,CAAAvB,QAAQ,CAACE,IAAI,CAACiB,WAAW,CAClC,CAAE,MAAOf,KAAK,CAAE,KAAAqB,gBAAA,CAAAC,qBAAA,CACd,MAAO,CAAA3B,eAAe,CAAC,EAAA0B,gBAAA,CAAArB,KAAK,CAACJ,QAAQ,UAAAyB,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBvB,IAAI,UAAAwB,qBAAA,iBAApBA,qBAAA,CAAsBnB,OAAO,GAAI,yBAAyB,CAAC,CACpF,CACF,CACF,CAAC,CAED,KAAM,CAAAoB,YAAY,CAAG,CACnBxB,MAAM,CAAE,CACNyB,OAAO,CAAE,CAAC,CACVC,eAAe,CAAE,CAAC,CAClBC,WAAW,CAAE,CAAC,CACdC,UAAU,CAAE,CACd,CAAC,CACDC,YAAY,CAAE,EAAE,CAChBC,UAAU,CAAE,CACVC,WAAW,CAAE,CAAC,CACdC,UAAU,CAAE,CAAC,CACbC,iBAAiB,CAAE,CAAC,CACpBC,OAAO,CAAE,KAAK,CACdC,OAAO,CAAE,KACX,CAAC,CACDC,OAAO,CAAE,KAAK,CACdnC,KAAK,CAAE,IACT,CAAC,CAED,KAAM,CAAAoC,WAAW,CAAG/D,WAAW,CAAC,CAC9BgE,IAAI,CAAE,QAAQ,CACdd,YAAY,CACZe,QAAQ,CAAE,CACRC,UAAU,CAAGC,KAAK,EAAK,CACrBA,KAAK,CAACxC,KAAK,CAAG,IAAI,CACpB,CAAC,CACDyC,aAAa,CAAEA,CAACD,KAAK,CAAEE,MAAM,GAAK,CAChCF,KAAK,CAACzC,MAAM,CAACyB,OAAO,CAAGkB,MAAM,CAACC,OAAO,CACvC,CAAC,CACDC,cAAc,CAAEA,CAACJ,KAAK,CAAEE,MAAM,GAAK,CACjCF,KAAK,CAACZ,YAAY,CAACiB,OAAO,CAACH,MAAM,CAACC,OAAO,CAAC,CAC5C,CACF,CAAC,CACDG,aAAa,CAAGC,OAAO,EAAK,CAC1BA,OACE;AAAA,CACCC,OAAO,CAACxD,WAAW,CAACyD,OAAO,CAAGT,KAAK,EAAK,CACvCA,KAAK,CAACL,OAAO,CAAG,IAAI,CACpBK,KAAK,CAACxC,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDgD,OAAO,CAACxD,WAAW,CAAC0D,SAAS,CAAE,CAACV,KAAK,CAAEE,MAAM,GAAK,CACjDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACzC,MAAM,CAAG2C,MAAM,CAACC,OAAO,CAC/B,CAAC,CAAC,CACDK,OAAO,CAACxD,WAAW,CAAC2D,QAAQ,CAAE,CAACX,KAAK,CAAEE,MAAM,GAAK,CAChDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACxC,KAAK,CAAG0C,MAAM,CAACC,OAAO,CAC9B,CAAC,CACD;AAAA,CACCK,OAAO,CAAC5C,iBAAiB,CAAC6C,OAAO,CAAGT,KAAK,EAAK,CAC7CA,KAAK,CAACL,OAAO,CAAG,IAAI,CACpBK,KAAK,CAACxC,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDgD,OAAO,CAAC5C,iBAAiB,CAAC8C,SAAS,CAAE,CAACV,KAAK,CAAEE,MAAM,GAAK,CACvDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACZ,YAAY,CAAGc,MAAM,CAACC,OAAO,CAACf,YAAY,CAChDY,KAAK,CAACX,UAAU,CAAGa,MAAM,CAACC,OAAO,CAACd,UAAU,CAC9C,CAAC,CAAC,CACDmB,OAAO,CAAC5C,iBAAiB,CAAC+C,QAAQ,CAAE,CAACX,KAAK,CAAEE,MAAM,GAAK,CACtDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACxC,KAAK,CAAG0C,MAAM,CAACC,OAAO,CAC9B,CAAC,CACD;AAAA,CACCK,OAAO,CAACrC,iBAAiB,CAACsC,OAAO,CAAGT,KAAK,EAAK,CAC7CA,KAAK,CAACL,OAAO,CAAG,IAAI,CACpBK,KAAK,CAACxC,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDgD,OAAO,CAACrC,iBAAiB,CAACuC,SAAS,CAAE,CAACV,KAAK,CAAEE,MAAM,GAAK,CACvDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACZ,YAAY,CAACiB,OAAO,CAACH,MAAM,CAACC,OAAO,CAAC,CAC1C;AACAH,KAAK,CAACzC,MAAM,CAACyB,OAAO,EAAIkB,MAAM,CAACC,OAAO,CAACS,MAAM,CAC/C,CAAC,CAAC,CACDJ,OAAO,CAACrC,iBAAiB,CAACwC,QAAQ,CAAE,CAACX,KAAK,CAAEE,MAAM,GAAK,CACtDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACxC,KAAK,CAAG0C,MAAM,CAACC,OAAO,CAC9B,CAAC,CACD;AAAA,CACCK,OAAO,CAAC9B,YAAY,CAAC+B,OAAO,CAAGT,KAAK,EAAK,CACxCA,KAAK,CAACL,OAAO,CAAG,IAAI,CACpBK,KAAK,CAACxC,KAAK,CAAG,IAAI,CACpB,CAAC,CAAC,CACDgD,OAAO,CAAC9B,YAAY,CAACgC,SAAS,CAAE,CAACV,KAAK,CAAEE,MAAM,GAAK,CAClDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACZ,YAAY,CAACiB,OAAO,CAACH,MAAM,CAACC,OAAO,CAAC,CAC1CH,KAAK,CAACzC,MAAM,CAACyB,OAAO,EAAIkB,MAAM,CAACC,OAAO,CAACS,MAAM,CAC/C,CAAC,CAAC,CACDJ,OAAO,CAAC9B,YAAY,CAACiC,QAAQ,CAAE,CAACX,KAAK,CAAEE,MAAM,GAAK,CACjDF,KAAK,CAACL,OAAO,CAAG,KAAK,CACrBK,KAAK,CAACxC,KAAK,CAAG0C,MAAM,CAACC,OAAO,CAC9B,CAAC,CAAC,CACN,CACF,CAAC,CAAC,CAEF,MAAO,MAAM,CAAEJ,UAAU,CAAEE,aAAa,CAAEG,cAAe,CAAC,CAAGR,WAAW,CAACiB,OAAO,CAChF,cAAe,CAAAjB,WAAW,CAACkB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}