{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport io from 'socket.io-client';\nimport { addNotification } from './notificationSlice';\nimport { updateBalance } from './walletSlice';\nimport { updateTaskInList } from './taskSlice';\nconst initialState = {\n  connection: null,\n  connected: false\n};\nconst socketSlice = createSlice({\n  name: 'socket',\n  initialState,\n  reducers: {\n    setSocket: (state, action) => {\n      state.connection = action.payload;\n      state.connected = true;\n    },\n    disconnectSocket: state => {\n      if (state.connection) {\n        state.connection.disconnect();\n      }\n      state.connection = null;\n      state.connected = false;\n    }\n  }\n});\nexport const {\n  setSocket,\n  disconnectSocket\n} = socketSlice.actions;\n\n// Thunk for initializing socket connection\nexport const initializeSocket = userId => dispatch => {\n  const socket = io(process.env.REACT_APP_API_URL || 'http://localhost:5000');\n  socket.on('connect', () => {\n    console.log('Connected to server');\n    socket.emit('join', userId);\n    dispatch(setSocket(socket));\n  });\n  socket.on('disconnect', () => {\n    console.log('Disconnected from server');\n    dispatch(disconnectSocket());\n  });\n\n  // Handle real-time notifications\n  socket.on('new_task', data => {\n    dispatch(addNotification({\n      type: 'info',\n      title: 'New Task Available',\n      message: data.message,\n      data: data.task\n    }));\n  });\n  socket.on('new_submission', data => {\n    dispatch(addNotification({\n      type: 'info',\n      title: 'New Submission',\n      message: `${data.worker.firstName} ${data.worker.lastName} submitted work for \"${data.task.title}\"`,\n      data: data.submission\n    }));\n  });\n  socket.on('task_approved', data => {\n    dispatch(addNotification({\n      type: 'success',\n      title: 'Task Approved!',\n      message: `Your submission for \"${data.task.title}\" was approved. You earned $${data.earnings}!`,\n      data: data.submission\n    }));\n\n    // Update wallet balance\n    dispatch(updateBalance(data.earnings));\n  });\n  socket.on('task_rejected', data => {\n    dispatch(addNotification({\n      type: 'error',\n      title: 'Task Rejected',\n      message: `Your submission for \"${data.task.title}\" was rejected. Please review the feedback.`,\n      data: data.submission\n    }));\n  });\n  socket.on('account_status_changed', data => {\n    dispatch(addNotification({\n      type: data.status === 'active' ? 'success' : 'warning',\n      title: 'Account Status Changed',\n      message: data.message\n    }));\n  });\n  return socket;\n};\nexport default socketSlice.reducer;","map":{"version":3,"names":["createSlice","io","addNotification","updateBalance","updateTaskInList","initialState","connection","connected","socketSlice","name","reducers","setSocket","state","action","payload","disconnectSocket","disconnect","actions","initializeSocket","userId","dispatch","socket","process","env","REACT_APP_API_URL","on","console","log","emit","data","type","title","message","task","worker","firstName","lastName","submission","earnings","status","reducer"],"sources":["C:/Users/HP/Desktop/TPAY/client/src/store/slices/socketSlice.js"],"sourcesContent":["import { createSlice } from '@reduxjs/toolkit';\r\nimport io from 'socket.io-client';\r\nimport { addNotification } from './notificationSlice';\r\nimport { updateBalance } from './walletSlice';\r\nimport { updateTaskInList } from './taskSlice';\r\n\r\nconst initialState = {\r\n  connection: null,\r\n  connected: false,\r\n};\r\n\r\nconst socketSlice = createSlice({\r\n  name: 'socket',\r\n  initialState,\r\n  reducers: {\r\n    setSocket: (state, action) => {\r\n      state.connection = action.payload;\r\n      state.connected = true;\r\n    },\r\n    disconnectSocket: (state) => {\r\n      if (state.connection) {\r\n        state.connection.disconnect();\r\n      }\r\n      state.connection = null;\r\n      state.connected = false;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { setSocket, disconnectSocket } = socketSlice.actions;\r\n\r\n// Thunk for initializing socket connection\r\nexport const initializeSocket = (userId) => (dispatch) => {\r\n  const socket = io(process.env.REACT_APP_API_URL || 'http://localhost:5000');\r\n  \r\n  socket.on('connect', () => {\r\n    console.log('Connected to server');\r\n    socket.emit('join', userId);\r\n    dispatch(setSocket(socket));\r\n  });\r\n\r\n  socket.on('disconnect', () => {\r\n    console.log('Disconnected from server');\r\n    dispatch(disconnectSocket());\r\n  });\r\n\r\n  // Handle real-time notifications\r\n  socket.on('new_task', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'info',\r\n      title: 'New Task Available',\r\n      message: data.message,\r\n      data: data.task,\r\n    }));\r\n  });\r\n\r\n  socket.on('new_submission', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'info',\r\n      title: 'New Submission',\r\n      message: `${data.worker.firstName} ${data.worker.lastName} submitted work for \"${data.task.title}\"`,\r\n      data: data.submission,\r\n    }));\r\n  });\r\n\r\n  socket.on('task_approved', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'success',\r\n      title: 'Task Approved!',\r\n      message: `Your submission for \"${data.task.title}\" was approved. You earned $${data.earnings}!`,\r\n      data: data.submission,\r\n    }));\r\n    \r\n    // Update wallet balance\r\n    dispatch(updateBalance(data.earnings));\r\n  });\r\n\r\n  socket.on('task_rejected', (data) => {\r\n    dispatch(addNotification({\r\n      type: 'error',\r\n      title: 'Task Rejected',\r\n      message: `Your submission for \"${data.task.title}\" was rejected. Please review the feedback.`,\r\n      data: data.submission,\r\n    }));\r\n  });\r\n\r\n  socket.on('account_status_changed', (data) => {\r\n    dispatch(addNotification({\r\n      type: data.status === 'active' ? 'success' : 'warning',\r\n      title: 'Account Status Changed',\r\n      message: data.message,\r\n    }));\r\n  });\r\n\r\n  return socket;\r\n};\r\n\r\nexport default socketSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}